{
    "type" : "app",

    "roles" : {
        "apache2" : {
            "defaultcontext" : "/webtrees",
            "depends" : [
                "php",
                "php-apache",
                "php-gd"
            ],
            "apache2modules" : [
                "php5"
            ],
            "phpmodules" : [
                "gd",
                "mysql",
                "mysqli",
                "pdo_mysql"
            ],
            "appconfigitems" : [
                {
                    "type" : "directorytree",
                    "names" : [
                        "action.php",
                        "addmedia.php",
                        "admin.php",
                        "admin_media.php",
                        "admin_media_upload.php",
                        "admin_module_blocks.php",
                        "admin_module_menus.php",
                        "admin_module_reports.php",
                        "admin_module_sidebar.php",
                        "admin_module_tabs.php",
                        "admin_modules.php",
                        "admin_pgv_to_wt.php",
                        "admin_site_access.php",
                        "admin_site_change.php",
                        "admin_site_clean.php",
                        "admin_site_config.php",
                        "admin_site_info.php",
                        "admin_site_logs.php",
                        "admin_site_merge.php",
                        "admin_site_other.php",
                        "admin_site_readme.php",
                        "admin_site_upgrade.php",
                        "admin_trees_check.php",
                        "admin_trees_config.php",
                        "admin_trees_download.php",
                        "admin_trees_export.php",
                        "admin_trees_manage.php",
                        "admin_trees_merge.php",
                        "admin_trees_places.php",
                        "admin_trees_renumber.php",
                        "autocomplete.php",
                        "block_edit.php",
                        "branches.php",
                        "calendar.php",
                        "compact.php",
                        "composer.json",
                        "composer.lock",
                        "descendancy.php",
                        "edit_changes.php",
                        "edit_interface.php",
                        "editnews.php",
                        "edituser.php",
                        "expand_view.php",
                        "family.php",
                        "familybook.php",
                        "famlist.php",
                        "fanchart.php",
                        "favicon.ico",
                        "find.php",
                        "gedrecord.php",
                        "help_text.php",
                        "hourglass.php",
                        "hourglass_ajax.php",
                        "import.php",
                        "includes",
                        "index.php",
                        "index_edit.php",
                        "indilist.php",
                        "individual.php",
                        "inverselink.php",
                        "js",
                        "language",
                        "library",
                        "lifespan.php",
                        "login.php",
                        "logout.php",
                        "mediafirewall.php",
                        "medialist.php",
                        "mediaviewer.php",
                        "message.php",
                        "module.php",
                        "modules_v3",
                        "note.php",
                        "notelist.php",
                        "pedigree.php",
                        "placelist.php",
                        "relationship.php",
                        "repo.php",
                        "repolist.php",
                        "reportengine.php",
                        "save.php",
                        "search.php",
                        "search_advanced.php",
                        "setup.php",
                        "site-offline.php",
                        "site-unavailable.php",
                        "source.php",
                        "sourcelist.php",
                        "statistics.php",
                        "statisticsplot.php",
                        "themes",
                        "timeline.php"
                    ],
                    "source" : "webtrees/$1",
                    "uname" : "root",
                    "gname" : "root",
                    "filepermissions" : "preserve",
                    "dirpermissions"  : "preserve"
                },
                {
                    "type"  : "directory",
                    "name"  : "${appconfig.datadir}"
                },
                {
                    "type"            : "directory",
                    "name"            : "${appconfig.datadir}/data",
                    "dirpermissions"  : "0750",
                    "filepermissions" : "0640",
                    "uname"           : "${apache2.uname}",
                    "gname"           : "${apache2.gname}"
                },
                {
                    "type"            : "directory",
                    "name"            : "${appconfig.datadir}/media",
                    "retentionpolicy" : "keep",
                    "retentionbucket" : "mediadir",
                    "dirpermissions"  : "0750",
                    "filepermissions" : "0640",
                    "uname"           : "${apache2.uname}",
                    "gname"           : "${apache2.gname}"
                },
                {
                    "type"            : "directory",
                    "name"            : "${appconfig.datadir}/cache",
                    "dirpermissions"  : "0750",
                    "uname"           : "${apache2.uname}",
                    "gname"           : "${apache2.gname}"
                },
                {
                    "type"         : "file",
                    "name"         : "${appconfig.datadir}/data/config.ini.php",
                    "template"     : "tmpl/config.ini.php.tmpl",
                    "templatelang" : "varsubst"
                },
                {
                    "type"         : "file",
                    "name"         : "${appconfig.apache2.appconfigfragmentfile}",
                    "template"     : "tmpl/htaccess.tmpl",
                    "templatelang" : "varsubst"
                },
                {
                    "type"         : "symlink",
                    "source"       : "${appconfig.datadir}/data",
                    "name"         : "data"
                }
            ],

            "installers" : [
                {
                    "type"   : "perlscript",
                    "source" : "bin/populate-db.pl"
                },
            ]
        },
        "mysql" : {
            "appconfigitems" : [
                {
                    "type"       : "database",
                    "name"       : "maindb",
                    "retentionpolicy"  : "keep",
                    "retentionbucket"  : "maindb",
                    "privileges" : "all privileges"
                }
            ],
            "installers" : [
                {
                    "type"   : "sqlscript",
                    "name"   : "maindb",
                    "source" : "sql/tables.sql"
                }
            ]
        }
    },
    "customizationpoints" : {
        "locale" : {
            "name"      : "Locale",
            "type"      : "string",
            "required"  : false,
            "default" : {
                "value" : "en-US"
            }
        }
    }
}


